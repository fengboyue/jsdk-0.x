/*!
 * @project JSDK JavaScript Development Kit
 * @copyright Copyright(c) 2004-2012, Dragonfly.org. All rights reserved.
 * @license LGPLv3
 * 
 * @version 0.1
 * @author feng.chun
 * @date 2007-8-30
 * 
 * @requires /core/js-core.js
 */
js.util.Validator=function(){return{REGS:{FULL_NUMBER:/^\d+$/,ENGLISH:/^[A-Za-z]+$/,ENGLISH_NUMBER:/^[A-Za-z\d]+$/,EMAIL:/^\w+(((-|&)\w*)|(\.\w+))*\@[A-Za-z0-9]+((\-)[A-Za-z0-9]*|(\.)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/,EMAIL_DOMAIN:/^@[A-Za-z0-9]+((\-)[A-Za-z0-9]*|(\.)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/,DATE:/^(\d{1,4})(-|\/)(\d{1,2})(-|\/)(\d{1,2})$/,DATE_TIME:/^(\d{1,4})(-|\/)(\d{1,2})(-|\/)(\d{1,2})\s(\d{1,2}):(\d{1,2}):(\d{1,2})$/,TIME:/^(\d{1,2}):(\d{1,2}):(\d{1,2})$/,HALF_ANGLE:/^[\u0000-\u00FF]+$/,ENTIRE_ANGLE_NOCHINESE:/^[\uFF00-\uFFFF]+$/,ENTIRE_ANGLE:/^[\u0391-\uFFE5]+$/,IP:/^(0|[1-9]\d?|[0-1]\d{2}|2[0-4]\d|25[0-5]).(0|[1-9]\d?|[0-1]\d{2}|2[0-4]\d|25[0-5]).(0|[1-9]\d?|[0-1]\d{2}|2[0-4]\d|25[0-5]).(0|[1-9]\d?|[0-1]\d{2}|2[0-4]\d|25[0-5])$/},isNotEmpty:function(a){if(!a||!a instanceof String){return false;}return a.length>0;},isEmpty:function(a){return !this.isNotEmpty(a);},isNull:function(a){return js.lang.System.isNull(a)||js.lang.System.isUndefined(a);},validateWith:function(c,b,a){if(this.isNull(c.trim())){return a?true:false;}c=c.trim();if(this.isEmpty(c)){return a?true:false;}return(c&&(new RegExp(b)).test(c));},isDate:function(b,a){return this.validateWith(b,this.REGS.DATE,a);},isDateTime:function(b,a){return this.validateWith(b,this.REGS.DATE_TIME,a);},isTime:function(b,a){return this.validateWith(b,this.REGS.TIME,a);},isIP:function(b,a){return this.validateWith(b,this.REGS.IP,a);},isEmail:function(b,a){return this.validateWith(b,this.REGS.EMAIL,a);},isEmailDomain:function(b,a){return this.validateWith(b,this.REGS.EMAIL_DOMAIN,a);},isFullNumber:function(b,a){return this.validateWith(b,this.REGS.FULL_NUMBER,a);},_isNumber:function(c,b,a){if(this.isNull(b.trim())){return a?true:false;}b=b.trim();if(this.isEmpty(b)){return a?true:false;}return Number[c](b);},isNumber:function(b,a){return this._isNumber("isNumber",b,a);},isFloat:function(b,a){return this._isNumber("isFloat",b,a);},isInt:function(b,a){return this._isNumber("isInt",b,a);},isNegative:function(b,a){return this._isNumber("isNegative",b,a);},isPositive:function(b,a){return this._isNumber("isPositive",b,a);},isNumberFormat:function(g,e,b){if(this.isNull(g.trim())){return b?true:false;}g=g.trim();if(this.isEmpty(g)){return b?true:false;}if(!e||!this.isNumber(g)){return false;}var d=e.split("."),h=Number.toNumber(g),c=h.intLength(),a=h.decLength();if(c>0&&d[0]){if(c>parseInt(d[0])){return false;}}if(a>0&&d[1]){if(a>parseInt(d[1])){return false;}}return true;},isTextLength:function(e,d,b){if(this.isNull(e.trim())){return b?true:false;}if(!d||!/^[(\d,\d]$)/.test(d)){return false;}var a=e.length,c=d.match(/\d+/g);if(a<c[0]){return false;}if(c.length>1){if(c[1]<c[0]){return false;}if(a>c[1]){return false;}}return true;},isSBC:function(b,a){return this.validateWith(b,this.REGS.HALF_ANGLE,a);},isDBC:function(b,a){return this.validateWith(b,this.REGS.ENTIRE_ANGLE,a);},isDBCWithoutChinese:function(b,a){return this.validateWith(b,this.REGS.ENTIRE_ANGLE_NOCHINESE,a);},isEngish:function(b,a){return this.validateWith(b,this.REGS.ENGLISH,a);},isEngishOrNumber:function(b,a){return this.validateWith(b,this.REGS.ENGLISH_NUMBER,a);}};}();js.util.HTMLCheckor=function(){var a=function(f){var e=f.tagName?f.tagName.toLowerCase():null;if(!e){return null;}var c="";switch(e){case"input":if(f.type=="radio"){f=document.getElementsByName(f.name);for(var d=0;d<f.length;d++){if(f[d].checked){c=f[d].value;}}}else{if(f.type=="checkbox"){f=document.getElementsByName(f.name);c=[];for(var d=0;d<f.length;d++){if(f[d].checked){c[c.length]=f[d].value;}}}else{c=f.value;}}break;case"select":if(f.type=="select-one"){if(f.selectedIndex!=-1){c=f.options[f.selectedIndex].value;}}else{if(f.type=="select-multiple"){c=[];for(var d=0;d<f.length;d++){if(f[d].selected){c[c.length]=f[d].value;}}}}break;case"textarea":c=f.value;break;}return c;};var b=function(e,d){var h=js.core.Dom.$(e);if(!h){return true;}var c=h.getAttribute("validate");if(!c){return true;}var f=a(h);if(!f){return true;}var g=js.lang.System.parseJSON(c);if(!g){return true;}if(!js.lang.System.isArray(g)){throw new Error("[js.util.HTMLCheckor]The validate rules invalid format.");}return g.every(function(k){if(k&&k.name){var i=true,l=js.util.Validator[k.name];if(l){try{i=l.apply(js.util.Validator,[f].concat(k.args||[]));}catch(j){}}if(!i){try{if(d){d.call(h,k,oldValue);}}catch(j){}finally{return i;}}}});};return{setRule:function(c,e){var d=js.core.Dom.$(c);if(d){d.setAttribute("validate",e);}},checkInput:function(c,d){return b(c,d);},checkForm:function(g,f){var j=js.core.Dom.$(g),e=j.elements,h=true;for(var d=0,c=e.length;d<c;d++){if(!this.checkInput(e[d],f)){h=false;}}return h;}};}();