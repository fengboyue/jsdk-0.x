<!--  -->
<HTML>
<HEAD>
<TITLE></TITLE>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<LINK REL ="stylesheet" TYPE="text/css" HREF="../inc/stylesheet.css">
</HEAD>

<BODY style="margin:5px;">
<div style="float:right;">
<span class="button" onclick="if(window.history.length > 1) window.history.go(-1);">Back</span>
</div>
<div style="margin-left:5px;">core\js-input-min.js</div>
<pre class="source">
<span class="multiComment">/*!
 * @project JSDK JavaScript Development Kit
 * @copyright Copyright(c) 2004-2012, Dragonfly.org. All rights reserved.
 * @license LGPLv3
 * 
 * @version 0.1
 * @author feng.chun
 * @date 2011-03-24
 * @date 2011-04-14
 * @date 2011-09-05
 *  
 * @requires /core/js-core.js
 */</span>
js.lang.System.namespace("js.input");js.input.KEY={BACK_SPACE:8,TAB:9,ENTER:13,SHIFT:16,CONTROL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINTSCREEN:44,INSERT:45,DELETE:46,NUMPAD0:96,NUMPAD1:97,NUMPAD2:98,NUMPAD3:99,NUMPAD4:100,NUMPAD5:101,NUMPAD6:102,NUMPAD7:103,NUMPAD8:104,NUMPAD9:105,MULTIPLY:106,PLUS:107,SUBTRACT:109,DECIMAL:110,DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUM_LOCK:144,SCROLL_LOCK:145,META:224};js.input.KeyBufferProvider=<b>function </b>(){};js.input.KeyBufferProvider.prototype={resetKeyBuffer:<b>function </b>(){<b>this</b>._KEY_MARK={};<b>this</b>._holdBuffer=0;<b>this</b>._holdKeys=[];<b>this</b>._keyLog=[];},getPressedKeyLog:<b>function </b>(b){<b>if </b>(!<b>this</b>._keyLog){<b>return</b> <b>null</b>;}<b>var </b>a=<b>this</b>._keyLog.length;<b>if </b>(a==0){<b>return</b> <b>null</b>;}b=(!b)?a:(b&gt;a?a:b);<b>return</b> <b>this</b>._keyLog.slice(0,b);},getHoldKeys:<b>function </b>(b){<b>if </b>(!<b>this</b>._holdKeys){<b>return</b> <b>null</b>;}<b>if </b>(!b){<b>return</b> <b>this</b>._holdKeys;}<b>var </b>a=b.join(",")+",";<b>return</b> <b>this</b>._holdKeys.filter(<b>function </b>(c){<b>return</b> a.indexOf(c+",")&gt;-1;});},_isKeyHold:<b>function </b>(a){<b>if </b>(!<b>this</b>._KEY_MARK){<b>return</b> <b>false</b>;}<b>return</b>(<b>this</b>._holdBuffer&<b>this</b>._KEY_MARK[a])!=0;},isKeyHold:<b>function </b>(a){<b>if </b>(js.lang.System.isArray(a)){<b>return</b> a.every(<b>function </b>(b){<b>return</b> <b>this</b>._isKeyHold(b);},<b>this</b>);}<b>else </b>{<b>return</b> <b>this</b>._isKeyHold(a);}},isKeyLastest:<b>function </b>(b){<b>if </b>(!<b>this</b>._keyLog){<b>return</b> <b>false</b>;}<b>var </b>a=<b>this</b>._keyLog.length;<b>if </b>(a==0){<b>return</b> <b>false</b>;}<b>var </b>d=(js.lang.System.isArray(b))?b.length:1;<b>if </b>(a&lt;d){<b>return</b> <b>false</b>;}<b>var </b>c=<b>this</b>._keyLog.slice(0,d);<b>return</b> c&&c.toString()==b.toString();},isKeyRepeat:<b>function </b>(b,c){<b>var </b>a=<b>this</b>.getLastestKeys(c);<b>if </b>(a.length!=c){<b>return</b> <b>false</b>;}<b>return</b> a.every(<b>function </b>(d){<b>return</b> d.code==b;});},setPressedKeyLoggable:<b>function </b>(a){<b>this</b>._keyLoggable=a;},isPressedKeyLoggable:<b>function </b>(){<b>return</b> <b>this</b>._keyLoggable?<b>true</b>:<b>false</b>;},onKeyHold:<b>function </b>(c,b,g){<b>if </b>(!c){<b>return</b>;}<b>if </b>(!<b>this</b>._KEY_MARK){<b>this</b>.resetKeyBuffer();}<b>var </b>m=<b>null</b>,h=<b>null</b>,a=<b>null</b>,j=<b>null</b>;<b>if </b>(b){m=b["fn"];h=b["scope"];}<b>if </b>(g){a=g["fn"];j=g["scope"];}<b>var </b>n=c["keys"],e=!n||n.length==0;<b>if </b>(e){c["keys"]=[];n=[];<b>if </b>(c["shift"]){c["keys"].push(js.input.KEY.SHIFT);n.push(js.input.KEY.SHIFT);}<b>if </b>(c["alt"]){c["keys"].push(js.input.KEY.ALT);n.push(js.input.KEY.ALT);}<b>if </b>(c["ctrl"]){c["keys"].push(js.input.KEY.CONTROL);n.push(js.input.KEY.CONTROL);}}<b>for </b>(<b>var </b>f=0,l=n.length;f&lt;l;f++){<b>this</b>._KEY_MARK[n[f]]=1&lt;&lt;f;}<b>this</b>.onKeyDown(c,{fn:<b>function </b>(o,i){<b>this</b>._holdBuffer|=<b>this</b>._KEY_MARK[i[0]];<b>if </b>(!<b>this</b>._holdKeys.contains(i[0])){<b>this</b>._holdKeys.push(i[0]);}<b>if </b>(<b>this</b>._keyLoggable){<b>if </b>(<b>this</b>._keyLog.length&gt;=32){<b>this</b>._keyLog.shift();}<b>this</b>._keyLog.insertAt(0,{code:i[0],time:<b>new </b>Date()});}<b>if </b>(m){m.call(h||<b>this</b>,i[0]);}}});<b>var </b>d={};<b>if </b>(e){d["keys"]=c["keys"];<b>if </b>(c["shift"]){d["shift"]=<b>false</b>;}<b>if </b>(c["alt"]){d["alt"]=<b>false</b>;}<b>if </b>(c["ctrl"]){d["ctrl"]=<b>false</b>;}}<b>this</b>.onKeyUp(e?d:c,{fn:<b>function </b>(p,o){<b>var </b>i=Math.log(<b>this</b>._KEY_MARK[o[0]])/Math.log(2);<b>this</b>._holdBuffer&=~(1&lt;&lt;i);<b>this</b>._holdKeys.remove(o[0]);<b>if </b>(a){a.call(j||<b>this</b>,o[0]);}}});},_addKeyListener:<b>function </b>(e,f,g){<b>if </b>(!g){<b>throw </b><b>new </b>TypeError();}<b>var </b>d=g["fn"],b=g["args"],c=g["scope"]||<b>this</b>;<b>if </b>(!d){<b>throw </b><b>new </b>TypeError();}<b>var </b>a=<b>new </b>js.util.KeyListener(document,f,{"fn":d,"scope":b,"correctScope":c},e);a.enable();<b>if </b>(!<b>this</b>._keyListeners){<b>this</b>._keyListeners={};}<b>this</b>._keyListeners[js.lang.System.getUUID()]=a;},onKeyUp:<b>function </b>(a,b){<b>this</b>._addKeyListener("keyup",a,b);},onKeyDown:<b>function </b>(a,b){<b>this</b>._addKeyListener("keydown",a,b);},disableAllKeys:<b>function </b>(){<b>for </b>(k<b> in </b><b>this</b>._keyListeners){<b>var </b>a=<b>this</b>._keyListeners[k];<b>if </b>(a){a.disable();}}},enableAllKeys:<b>function </b>(){<b>for </b>(k<b> in </b><b>this</b>._keyListeners){<b>var </b>a=<b>this</b>._keyListeners[k];<b>if </b>(a){a.enable();}}},removeAllKeys:<b>function </b>(){<b>this</b>.disableAllKeys();<b>this</b>._keyListeners={};}};js.input.Mouse={LEFT:0,CENTER:1,RIGHT:2};js.input.MouseProvider=<b>function </b>(){};js.input.MouseProvider.prototype={_getCacheIndex4Mouse:<b>function </b>(h,j,g,f){<b>var </b>d=<b>this</b>._mouseCache;<b>for </b>(<b>var </b>e=0,c=d.length;e&lt;c;e++){<b>var </b>b=d[e];<b>if </b>(b&&b["fn"]==g&&b["el"]==h&&b["type"]==j&&b["button"]==f){<b>return</b> e;}}<b>return</b> -1;},_cacheMouseFn:<b>function </b>(d,e,c,a,b){<b>if </b>(!<b>this</b>._mouseCache){<b>this</b>._mouseCache=[];}<b>this</b>._mouseCache.push({"fn":c,"type":e,"el":d,"button":b,"wfn":a});},_clearCacheItem4Mouse:<b>function </b>(a){<b>delete </b><b>this</b>._mouseCache[a]["wfn"];<b>delete </b><b>this</b>._mouseCache[a]["fn"];<b>this</b>._mouseCache.splice(a,1);},_fixMouseButton:<b>function </b>(a){<b>if </b>(js.lang.System.isUndefined(a)){a=0;}<b>if </b>(js.core.Env.ie){<b>switch </b>(a){<b>case </b>1:<b>return</b> 4;<b>case </b>2:<b>return</b> 2;default:<b>return</b> 1;}}<b>return</b> a;},onMouseShift:<b>function </b>(d,e,c,a,b){<b>return</b> js.core.Event.addListener(d,"mouse"+e,c,a,b||<b>this</b>);},onMouseTap:<b>function </b>(f,g,e,b,d,c){f=js.core.Dom.$(f);<b>if </b>(!f||!g||!e){<b>return</b> <b>false</b>;}c=<b>this</b>._fixMouseButton(c);<b>var </b>a=<b>function </b>(i,h){<b>if </b>(i.button==c){<b>return</b> e.call(<b>this</b>,i,h);}};<b>this</b>._cacheMouseFn(f,g,e,a,c);<b>return</b> js.core.Event.addListener(f,(g=="click"||g=="dblclick")?g:("mouse"+g),a,b,d||<b>this</b>);},onMouseLeftTap:<b>function </b>(d,e,c,a,b){<b>return</b> <b>this</b>.onMouseTap(d,e,c,a,b,0);},onMouseCenterTap:<b>function </b>(d,e,c,a,b){<b>return</b> <b>this</b>.onMouseTap(d,e,c,a,b,1);},onMouseRightTap:<b>function </b>(d,e,c,a,b){<b>return</b> <b>this</b>.onMouseTap(d,e,c,a,b,2);},rmMouseTap:<b>function </b>(d,e,c,b){d=js.core.Dom.$(d);<b>if </b>(!d||!e||!c){<b>return</b> <b>false</b>;}b=<b>this</b>._fixMouseButton(b);<b>var </b>a=<b>this</b>._getCacheIndex4Mouse(d,e,c,b);<b>if </b>(a==-1){<b>return</b> <b>false</b>;}<b>var </b>f=js.core.Event.removeListener(d,(e=="click"||e=="dblclick")?e:("mouse"+e),<b>this</b>._mouseCache[a]);<b>this</b>._clearCacheItem4Mouse(a);<b>return</b> f;},rmMouseLeftTap:<b>function </b>(c,d,b,a){<b>return</b> <b>this</b>.rmMouseTap(c,d,b,0);},rmMouseCenterTap:<b>function </b>(c,d,b,a){<b>return</b> <b>this</b>.rmMouseTap(c,d,b,1);},rmMouseRightTap:<b>function </b>(c,d,b,a){<b>return</b> <b>this</b>.rmMouseTap(c,d,b,2);}};

</pre>
<hr/>
</BODY>
</HTML>
